<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Output</title>
    <style>
        /* .logo{
            background-image: url('msu-wordmark-green.svg');
            width: 200px;
            height: 200px;
            background-size: contain;
            background-repeat: no-repeat;
            margin: 0 auto;
        } */

        /* msulogo{
            width: 400px;
            height: 200px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            margin: 0 auto;
            text-align: center; 
        } */

        /* msulogo {
           
            margin-top: 20px; /* Adjust as necessary 

            } */

        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            color: #333;
            margin: 0 100px;
            padding: 20px;
            /* align-items: center; */

        }

        h1 {
            background-color: #22453a;
            color: white;
            padding: 10px;
            text-align: center;
            margin-bottom: 20px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            border: 1px solid #dddddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #22453a;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            background-color: #f4f4f4;
            color: #333;
        }

        .msu-logo {
            max-width: 400px;
            height: 200px;
            display: block;
            margin: 20px auto;
        }

        .form-container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #18453B;
            margin-bottom: 20px;
            border-bottom: 2px solid #18453B;
            padding-bottom: 10px;
        }

        .output-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 20px;
            color: #22453a;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            border: 1px solid #dddddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #22453a;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .button-container {
            text-align: center;
            margin-top: 20px;
        }

        .button-container input[type="button"],
        .button-container .loading-button {
            padding: 10px 20px;
            background-color: #22453a;
            border: none;
            color: white;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }

        .button-container input[type="button"]:hover,
        .button-container .loading-button:hover {
            background-color: #45a049;
        }

        .button-container .loading-button {
            position: relative;
        }

        .loading-button span {
            display: inline-block;
            transition: 0.5s;
        }

        .loading-button span:after {
            content: '\00bb';
            position: absolute;
            opacity: 0;
            top: 0;
            right: -10px;
            transition: 0.5s;
        }

        .loading-button:hover span {
            padding-right: 20px;
        }

        .loading-button:hover span:after {
            opacity: 1;
            right: 0;
        }

        .loading-button:active {
            background: #45a049;
        }

        .button--loading .button__text {
            visibility: hidden;
            opacity: 0;
        }

        .button--loading::after {
            content: "";
            position: absolute;
            width: 16px;
            height: 16px;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: auto;
            border: 4px solid transparent;
            border-top-color: #ffffff;
            border-radius: 50%;
            animation: button-loading-spinner 1s ease infinite;
        }

        @keyframes button-loading-spinner {
            from {
                transform: rotate(0turn);
            }

            to {
                transform: rotate(1turn);
            }
        }

        #economicAnalysisForm {
            display: none;
            margin-top: 20px;
            /* align-items: center;
            gap: 10px; /* Spacing between elements
            margin-bottom: 15px; Add spacing between form rows */
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        label {
            font-weight: bold;
            margin-top: 10px;
            display: block;
            white-space: nowrap;
            /* Prevent text wrapping */
        }

        input[type="number"],
        select {
            width: calc(100% - 22px);
            padding: 10px;
            margin-top: 5px;
            border-radius: 4px;
            border: 1px solid #ddd;
            display: block;
        }

        .form-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            gap: 20px;
        }

        .form-group {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #18453B;
        }

        .form-group input,
        .form-group select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            width: 100%;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #18453B;
            box-shadow: 0 0 0 2px rgba(24, 69, 59, 0.2);
        }

        .button-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .button {
            background-color: #18453B;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .button:hover {
            background-color: #12332c;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 15px;
            }

            .form-container {
                padding: 20px;
                margin: 0 10px;
            }
        }
    </style>
</head>

<body>
    <!-- <div class="logo"></div> -->

    <!-- <img src="https://logos-world.net/wp-content/uploads/2022/07/Michigan-State-University-Primary-Logo.png" 
    alt="MSU Logo" width="400" height="200" align="middle"> -->

    <div class="msulogo">
        <center><img src="https://logos-world.net/wp-content/uploads/2022/07/Michigan-State-University-Primary-Logo.png"
                alt="MSU Logo" width="400" height="200"></center>
    </div>
    <div class="button-container">
        <input type="button" value="Recalculate" onclick="toggleForm()">
        <input type="button" value="Home" onclick="window.location.href='/'">
    </div>
    <h2>Economic Analysis Results</h2>
    <table>
        <thead>
            <tr>
                <th style="text-align: center;">Metric</th>
                <th style="text-align: center;">Value (acres)</th>
                <th style="text-align: center;">$/acre</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Present Value (PV) of forestry activities without extended rotation.</td>
                <td style="text-align: center;" id="npv1">{{ npv1 }}</td>
                <td style="text-align: center;">{{ npv1_per_acre }}</td>
            </tr>
            <tr>
                <td>PV of forestry activities after extending rotation without carbon payments.</td>
                <td style="text-align: center;" id="npv2">{{ npv2 }}</td>
                <td style="text-align: center;">{{ npv2_per_acre }}</td>
            </tr>
            <tr>
                <td>Economic loss of extending rotation for carbon management without carbon payment,</td>
                <td style="text-align: center;" id="npv21">{{ npv21 }}</td>
                <td style="text-align: center;">{{ npv21_per_acre }}</td>
            </tr>
            <tr>
                <td>Revenue for carbon payment for enrolling into a carbon management program with extended
                    rotation,</td>
                <td style="text-align: center;" id="npv3">{{ npv3 }}</td>
                <td style="text-align: center;">{{ npv3_per_acre }}</td>
            </tr>
            <tr>
                <td>PV of forestry activities after extending rotation with carbon payments.</td>
                <td style="text-align: center;" id="npv4">{{ npv4 }}</td>
                <td style="text-align: center;">{{ npv4_per_acre }}</td>
            </tr>
            <tr>
                <td>Economic loss/benefit of extending rotation for carbon management with carbon payment,</td>
                <td style="text-align: center;" id="npv5">{{ npv5 }}</td>
                <td style="text-align: center;">{{ npv5_per_acre }}</td>
            </tr>
        </tbody>
    </table>

    <p style="text-align: center;">Note: A negative value represents a loss</p>

    <h2>Information From Previous Tables</h2>

    <table border="1" id="summary_table">
        <thead>
            <tr>
                <th style="text-align: center;">Item</th>
                <th style="text-align: center;">Values</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Years from now will you harvest under a business as usual scenario</td>
                <td style="text-align: center;">{{ hyb }}</td>
            </tr>
            <tr>
                <td>Harvest Year after Extended Rotation</td>
                <td style="text-align: center;">{{ hye }}
                </td>
            </tr>
            <tr>
                <td>NET Ecosystem Carbon Sequestration from adopting the planned activity (cumulative) ( t CO2eq).
                    (additional sequestration as compared to the BAU scenario</td>
                <td style="text-align: center;">{{ eco_carbon }}</td>
            </tr>
            <tr>
                <td>Benefit from Extending Rotation (i.e., the difference between BAU and Planned Activity Scenario
                    results) (t CO2eq). )</td>
                <td style="text-align: center;">{{ benefit }}</td>
            </tr>
            <tr>
                <td>Area subject to management activity (acres) </td>
                <td style="text-align: center;">{{ area }}</td>
            </tr>
            <tr>
                <td>Carbon sequestration in living and dead carbon pools (not soil) (t CO2eq)</td>
                <td style="text-align: center;">{{ carbon_seq }}</td>
            </tr>
            <tr>
                <td>TOTAL HWP Biogenic Carbon Stored from Harvest (t CO2eq)</td>
                <td style="text-align: center;">{{ total_hwp }}</td>
            </tr>
            <tr>
                <td>TOTAL AFOLU (Forest) BIOGENIC CARBON STOCK CHANGE (FLUX) from Management Action and Harvest (t
                    CO2eq).</td>
                <td style="text-align: center;">{{ total_afolu }}</td>
            </tr>
        </tbody>
    </table>
    
    <h2>Information on Harvest from Business as Usual (BAU) and Extended Rotation</h2>

    <table border="1" id="summary_table">
        <thead>
            <tr>
                <th style="text-align: center;">Item</th>
                <th style="text-align: center;">Value (CCF)</th>
                <th style="text-align: center;">Value</th>
                <th style="text-align: center;">Units</th>
            </tr>
        </thead>
        <tbody>
            {% for value in ccf.combined %}
                <tr>
                    <td>{{ value }} - Business as Usual (BAU)</td>
                    <td style="text-align: center;">{{ (ccf.a_values[loop.index0])|round|int|format_number_with_commas }}</td>
                    <td style="text-align: center;">
                        {% if 'Softwood Sawlog' in value %}
                            {% if economic_data.p1_unit == '$/MBF (International)' %}
                                {{ (ccf.a_values[loop.index0]|float * x1)|round|int|format_number_with_commas }}
                            {% elif economic_data.p1_unit == '$/MBF (Scribner)' %}
                                {{ (ccf.a_values[loop.index0]|float * x1 * z1)|round|int|format_number_with_commas }}
                            {% elif economic_data.p1_unit == '$/MBF (Doyle)' %}
                                {{ (ccf.a_values[loop.index0]|float * x1 * z2)|round|int|format_number_with_commas }}
                            {% else %}
                                {{ ccf.a_values[loop.index0] }}
                            {% endif %}
                        {% elif 'Softwood Pulpwood' in value and economic_data.p2_unit == '$/cord' %}
                            {{ (ccf.a_values[loop.index0]|float * x9)|round|int|format_number_with_commas }}
                        {% elif 'Hardwood Pulpwood' in value and economic_data.p5_unit == '$/cord' %}
                            {{ (ccf.a_values[loop.index0]|float * x10)|round|int|format_number_with_commas }}
                        {% elif 'Hardwood Sawlog' in value %}
                            {% if economic_data.p4_unit == '$/MBF (International)' %}
                                {{ (ccf.a_values[loop.index0]|float * x2)|round|int|format_number_with_commas }}
                            {% elif economic_data.p4_unit == '$/MBF (Scribner)' %}
                                {{ (ccf.a_values[loop.index0]|float * x2 * z1)|round|int|format_number_with_commas }}
                            {% elif economic_data.p4_unit == '$/MBF (Doyle)' %}
                                {{ (ccf.a_values[loop.index0]|float * x2 * z2)|round|int|format_number_with_commas }}
                            {% else %}
                                {{ (ccf.a_values[loop.index0])|round|int|format_number_with_commas }}
                            {% endif %}
                        {% else %}
                            {{ (ccf.a_values[loop.index0])|round|int|format_number_with_commas }}
                        {% endif %}
                    </td>
                    {% if 'Softwood Sawlog' in value %}
                        <td style="text-align: center;">{{ economic_data.p1_unit }}</td>
                    {% elif 'Softwood Pulpwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p2_unit }}</td>
                    {% elif 'Hardwood Sawlog' in value %}
                        <td style="text-align: center;">{{ economic_data.p4_unit }}</td>
                    {% elif 'Hardwood Pulpwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p5_unit }}</td>
                    {% else %}
                        <td style="text-align: center;">{{ economic_data.p1_unit }}</td>
                    {% endif %}
                </tr>
            
                <tr>
                    <td>{{ value }} - Extended Rotation</td>
                    <td style="text-align: center;">{{ (ccf.b_values[loop.index0])|round|int|format_number_with_commas }}</td>
                    <td style="text-align: center;">
                        {% if 'Softwood Sawlog' in value %}
                            {% if economic_data.p1_unit == '$/MBF (International)' %}
                                {{ (ccf.b_values[loop.index0]|float * x1)|round|int|format_number_with_commas }}
                            {% elif economic_data.p1_unit == '$/MBF (Scribner)' %}
                                {{ (ccf.b_values[loop.index0]|float * x1 * z1)|round|int|format_number_with_commas }}
                            {% elif economic_data.p1_unit == '$/MBF (Doyle)' %}
                                {{ (ccf.b_values[loop.index0]|float * x1 * z2)|round|int|format_number_with_commas }}
                            {% else %}
                                {{ ccf.b_values[loop.index0] }}
                            {% endif %}
                        {% elif 'Softwood Pulpwood' in value and economic_data.p2_unit == '$/cord' %}
                            {{ (ccf.b_values[loop.index0]|float * x9)|round|int|format_number_with_commas }}
                        {% elif 'Hardwood Pulpwood' in value and economic_data.p5_unit == '$/cord' %}
                            {{ (ccf.b_values[loop.index0]|float * x10)|round|int|format_number_with_commas }}
                        {% elif 'Hardwood Sawlog' in value %}
                            {% if economic_data.p4_unit == '$/MBF (International)' %}
                                {{ (ccf.b_values[loop.index0]|float * x2)|round|int|format_number_with_commas }}
                            {% elif economic_data.p4_unit == '$/MBF (Scribner)' %}
                                {{ (ccf.b_values[loop.index0]|float * x2 * z1)|round|int|format_number_with_commas }}
                            {% elif economic_data.p4_unit == '$/MBF (Doyle)' %}
                                {{ (ccf.b_values[loop.index0]|float * x2 * z2)|round|int|format_number_with_commas }}
                            {% else %}
                                {{ (ccf.b_values[loop.index0])|round|int|format_number_with_commas }}
                            {% endif %}
                        {% else %}
                            {{ (ccf.b_values[loop.index0])|round|int|format_number_with_commas }}
                        {% endif %}
                    </td>
                    {% if 'Softwood Sawlog' in value %}
                        <td style="text-align: center;">{{ economic_data.p1_unit }}</td>
                    {% elif 'Softwood Pulpwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p2_unit }}</td>
                    {% elif 'Softwood Fuelwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p3_unit }}</td>
                    {% elif 'Hardwood Sawlog' in value %}
                        <td style="text-align: center;">{{ economic_data.p4_unit }}</td>
                    {% elif 'Hardwood Pulpwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p5_unit }}</td>
                    {% elif 'Hardwood Fuelwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p6_unit }}</td>
                    {% else %}
                        <td style="text-align: center;">{{ economic_data.p1_unit }}</td>
                    {% endif %}
                </tr>
                
                <tr>
                    <td>{{ value }} - Difference</td>
                    <td style="text-align: center;">{{ (ccf.a_minus_b_values[loop.index0])|round|int|format_number_with_commas }}</td>
                    <td style="text-align: center;">{{ (ccf.a_minus_b_values[loop.index0])|round|int|format_number_with_commas }}</td>
                    {% if 'Softwood Sawlog' in value %}
                        <td style="text-align: center;">{{ economic_data.p1_unit }}</td>
                    {% elif 'Softwood Pulpwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p2_unit }}</td>
                    {% elif 'Softwood Fuelwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p3_unit }}</td>
                    {% elif 'Hardwood Sawlog' in value %}
                        <td style="text-align: center;">{{ economic_data.p4_unit }}</td>
                    {% elif 'Hardwood Pulpwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p5_unit }}</td>
                    {% elif 'Hardwood Fuelwood' in value %}
                        <td style="text-align: center;">{{ economic_data.p6_unit }}</td>
                    {% else %}
                        <td style="text-align: center;">{{ economic_data.p1_unit }}</td>
                    {% endif %}
                </tr>
                {% endfor %}
        </tbody>
    </table>

    <p style="text-align: center;">Note: The harvest in Business as usual and Extended rotation does not happen in the same year. The differences presented here is for information only. We use Present Value approach to account for harvest (converted to revenues at different years) to perform economic analysis to account for harvesting in different years.</p>

    <hr>

    <form id="economicAnalysisForm">
        <div class="form-row">
            <div class="form-group">
                <label for="p1">What is the price for softwood sawlog?</label>
                <input type="number" id="p1" name="p1" placeholder="Enter sawlog price" value="180" required>
            </div>
            <div class="form-group">
                <label for="p1_unit">Select the units for softwood sawlog</label>
                <select name="softwood-sawlog-unit" id="p1_unit">
                    <option value="mbf-scribner">$/MBF (Scribner)</option>
                    <option value="mbf-doyle">$/MBF (Doyle)</option>
                    <option value="mbf-international" selected>$/MBF (International)</option>
                    <option value="mbf-other">$/cord</option>
                    <option value="ton-short">$/ton (short)</option>
                    <option value="cubic-unit">$/cunit</option>
                    <option value="cubic-foot">$/cubic foot</option>
                    <option value="cubic-meters">$/cubic meters</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="p2">What is the price for softwood pulpwood?</label>
                <input type="number" id="p2" name="p2" placeholder="Enter pulpwood price" value="10" required>
            </div>
            <div class="form-group">
                <label for="p2_unit">Select the units for softwood pulpwood</label>
                <select name="softwood-pulpwood-unit" id="p2_unit">
                    <option value="mbf-other">$/cord</option>
                    <option value="ton-short">$/ton (short)</option>
                    <option value="cubic-unit">$/cunit</option>
                    <option value="cubic-foot">$/cubic foot</option>
                    <option value="cubic-meters">$/cubic meters</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="p3">What is the price for softwood fuelwood?</label>
                <input type="number" id="p3" name="p3" placeholder="Enter price" value="15" required>
            </div>
            <div class="form-group">
                <label for="p3_unit">Select the units for softwood fuelwood</label>
                <select name="softwood-fuelwood-unit" id="p3_unit">
                    <option value="mbf-other">$/cord</option>
                    <option value="ton-short">$/ton (short)</option>
                    <option value="cubic-unit">$/cunit</option>
                    <option value="cubic-foot">$/cubic foot</option>
                    <option value="cubic-meters">$/cubic meters</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="p4">What is the price for hardwood sawlog?</label>
                <input type="number" id="p4" name="p4" placeholder="Enter price" value="50" required>
            </div>
            <div class="form-group">
                <label for="p4_unit">Select the units for hardwood sawlog</label>
                <select name="hardwood-sawlog-unit" id="p4_unit">
                    <option value="mbf-scribner">$/MBF (Scribner)</option>
                    <option value="mbf-doyle">$/MBF (Doyle)</option>
                    <option value="mbf-international">$/MBF (International)</option>
                    <option value="mbf-other">$/cord</option>
                    <option value="ton-short">$/ton (short)</option>
                    <option value="cubic-unit">$/cunit</option>
                    <option value="cubic-foot">$/cubic foot</option>
                    <option value="cubic-meters">$/cubic meters</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="p5">What is the price for hardwood pulpwood? ($/quartz)</label>
                <input type="number" id="p5" name="p5" placeholder="Enter price" value="15" required>
            </div>
            <div class="form-group">
                <label for="p5_unit">Select the units for hardwood pulpwood</label>
                <select name="hardwood-pulpwood-unit" id="p5_unit">
                    <option value="mbf-other">$/cord</option>
                    <option value="ton-short">$/ton (short)</option>
                    <option value="cubic-unit">$/cunit</option>
                    <option value="cubic-foot">$/cubic foot</option>
                    <option value="cubic-meters">$/cubic meters</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="p6">What is the price for hardwood fuelwood? ($/ton)</label>
                <input type="number" id="p6" name="p6" placeholder="Enter price" value="15" required>
            </div>
            <div class="form-group">
                <label for="p6_unit">Select the units for softwood sawlog</label>
                <select name="hardwood-fuelwood-unit" id="p6_unit">
                    <option value="mbf-other">$/cord</option>
                    <option value="ton-short">$/ton (short)</option>
                    <option value="cubic-unit">$/cunit</option>
                    <option value="cubic-foot">$/cubic foot</option>
                    <option value="cubic-meters">$/cubic meters</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="interestRate">What is the interest rate? (%)</label>
                <input type="number" id="interestRate" name="interestRate" placeholder="Enter interest rate" value="5"
                    required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="carbonPrice">Provide the tentative payment for carbon, if enrolled into forest carbon offset
                    programs</label>
                <div class="form-row">
                    <input type="number" id="carbonPrice" name="carbonPrice" placeholder="Enter price of carbon"
                        value="10" required>
                    <select name="carbon-price-unit" id="p7_unit">
                        <option value="tonne-co2eq">$/tonne of CO2eq</option>
                        <option value="acre-year">$/acre/year</option>
                    </select>
                </div>
            </div>
        </div>
        </div>

        <div class="button-container">
            <button type="button" class="loading-button" id="submit-button">
                <span class="button__text">Recalculate</span>
            </button>
        </div>


        <p style="text-align: center;"><b>Disclaimer:</b>These values do not qualify you for carbon credit payments or
            programs.
            These are just a guide to help you understand the forest carbon credits generated from extended rotation.
            Please work with a qualified Forest Carbon Program developer if you would like to enroll into forest carbon
            programs.</p>
        <p style="text-align: center;">If you would like to learn more about Forest Carbon programs, click the following
            links to access recorded webinars and other information.</p>
    </form>
        <script>
            let isProcessing = false;

            function toggleForm() {
                document.getElementById("economicAnalysisForm").style.display = "block";
            }

            function roundNumber(x) {
                return Math.floor(x);
            }

            function formatNumberWithCommas(x) {
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            function roundAndFormatNumber(x) {
                return formatNumberWithCommas(roundNumber(x));
            }

            function submitEconomicAnalysis() {
                // Gather the form data
                var economicData = {
                    p1: document.getElementById("p1")?.value,
                    p1_unit: document.getElementById("p1_unit")?.value,
                    p2: document.getElementById("p2")?.value,
                    p2_unit: document.getElementById("p2_unit")?.value,
                    p3: document.getElementById("p3")?.value,
                    p3_unit: document.getElementById("p3_unit")?.value,
                    p4: document.getElementById("p4")?.value,
                    p4_unit: document.getElementById("p4_unit")?.value,
                    p5: document.getElementById("p5")?.value,
                    p5_unit: document.getElementById("p5_unit")?.value,
                    p6: document.getElementById("p6")?.value,
                    p6_unit: document.getElementById("p6_unit")?.value,
                    interestRate: document.getElementById("interestRate")?.value,
                    carbonPrice: document.getElementById("carbonPrice")?.value,
                    unit: document.getElementById("unit")?.value
                };

                // Send the data to the server
                fetch('/calculate_factor', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ economicData: economicData }),
                })
                    .then(response => {
                        if (response.ok) {
                            return response.json();
                        } else {
                            throw new Error('Failed to submit the form.');
                        }
                    })
                    .then(data => {
                        // Redirect to the final output page
                        // window.location.href = '/finaloutput';
                        const { npv1, npv2, npv21, npv3, npv4, npv5 } = data.npv_values;
                        document.getElementById("npv1").textContent = roundAndFormatNumber(npv1);
                        document.getElementById("npv2").textContent = roundAndFormatNumber(npv2);
                        document.getElementById("npv21").textContent = roundAndFormatNumber(npv21);
                        document.getElementById("npv3").textContent = roundAndFormatNumber(npv3);
                        document.getElementById("npv4").textContent = roundAndFormatNumber(npv4);
                        document.getElementById("npv5").textContent = roundAndFormatNumber(npv5);
                        document.getElementById('submit-button').classList.toggle("button--loading");
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                    });
            }

            document.getElementById('submit-button').addEventListener('click', function () {
                this.classList.add("button--loading");
                submitEconomicAnalysis();
            });


        </script>
        <hr>

        <p style="text-align: center;">The estimates presented in this analysis are derived from generalized information and may not fully capture the nuances of real-world carbon sequestration efforts. For landowners and managers interested in optimizing forests for carbon management and enrolling in a forest carbon program, we strongly recommend consulting with a professional forest carbon program developer. Their expertise can help tailor strategies to your specific forest conditions and maximize the potential benefits of participating in such programs.</p> 
        <p style="text-align: center;">To learn more about forest carbon payment programs, a series of webinars is available from the following <a href="https://www.canr.msu.edu/socioeconomics/Workshops/Building-forest-carbon-and-market-decision-support/webinars">link</a></p>
        <p style="text-align: center;">Also, please register for workshops (Between April and August 2025) on forest carbon decision support if you would like to learn more about forest carbon programs in the Eastern United States through the following <a href="https://www.canr.msu.edu/socioeconomics/Workshops/Building-forest-carbon-and-market-decision-support/workshops">link</a></p>
</body>

</html>